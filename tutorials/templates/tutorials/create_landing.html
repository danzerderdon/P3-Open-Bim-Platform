{% extends "base.html" %}
{% load static %}

{% block title %}Tutorials erstellen{% endblock %}

{% block content %}

<!-- Hauptinhalt mit √úberlappung -->
<div class="section-container" style="max-width: 60%,">
    <div class="card-container">
    <div style="text-align: center; padding: 10;">
        <h1>Tutorials erstellen</h1>
        <p>Hier kannst du neue Tutorials anlegen.</p>
        <p>Im Bereich unten kannst du deine bereits erstellten Tutorials sehen, bearbeiten oder L√∂schen falls sie nicht mehr gebraucht werden.</p>
        <a href="{% url 'tutorial_creator' %}">
            <button class="action-button orange" style="font-size: 20px;">+ Neues Tutorial erstellen</button>
        </a>
    </div>
        </div>

    <h1>Meine Tutorials:</h1>

    {% for tutorial in tutorials %}

    <div class="tutorial-card {{ tutorial.difficulty|default:'mittel' }}">

        <h2><strong>{{ tutorial.title }}</strong></h2>
        {% if tutorial.thumbnail %}
            <img src="{{ tutorial.thumbnail.url }}" alt="Vorschaubild"
                 style="max-width: 100%; border-radius: 10px; margin-bottom: 15px;">
        {% endif %}

        <p>{{ tutorial.description }}</p>
        <p style="color: #555; font-size: 14px;">Erstellt am: {{ tutorial.created_at|date:"d.m.Y H:i" }}</p>

        {% if request.user.groups.all.0.name == "BIM Expert" %}
        <h3>Tutorial Bearbeiten:</h3>
        <div style="margin-top: 20px;">
            <a href="{% url 'edit_tutorial_sections' tutorial.id %}">
                <button class="action-button blue">Schritte</button>
            </a>
            <a href="{% url 'edit_quiz' tutorial.id %}">
                <button class="action-button blue">Fragen</button>
            </a>
            <a href="{% url 'edit_tutorial_attributes' tutorial.id %}">
                <button class="action-button orange">Attribute</button>
            </a>
            <form class="delete-form" action="{% url 'delete_tutorial' tutorial.id %}" method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="action-button red">L√∂schen</button>
            </form>
        </div>
        {% endif %}
    </div>
    {% empty %}
    <p style="text-align: center;">Du hast noch keine Tutorials erstellt.</p>
    {% endfor %}
</div>

<!-- Stile f√ºr Buttons -->
<style>
.action-button {
    color: white;
    padding: 10px 15px;
    border: none;
    border-radius: 6px;
    margin: 5px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
    outline: none;
    box-shadow: none;
}

.action-button:focus {
    outline: none;
}

.action-button.blue {
    background-color: #0d5c75;
}

.action-button.blue:hover {
    background-color: #2b9bc4;
}

.action-button.orange {
    background-color: #f0c954;
}

.action-button.orange:hover {
    background-color: #f5b041;
}

.action-button.red {
    background-color: #f27b81;
}

.action-button.red:hover {
    background-color: red;
}

.action-button.grey {
    background-color: #7f8c8d;
}

.action-button.grey:hover {
    background-color: #95a5a6;
}
    .tutorial-card.leicht {
    border: 3px solid #27ae60; /* gr√ºn */
}

.tutorial-card.mittel {
    border: 3px solid #f1c40f; /* gelb */
}

.tutorial-card.schwer {
    border: 3px solid #e74c3c; /* rot */
}

.tutorial-card.expert {
    border: 3px solid #8e44ad; /* lila */
}

</style>

<!-- JS f√ºr √úbergang + L√∂schbest√§tigung -->
<script>
    // Fade beim Laden
    document.body.style.opacity = 0;
    window.addEventListener('load', () => {
        document.body.style.transition = "opacity 0.6s ease";
        document.body.style.opacity = 1;
    });

    // Fade-Out bei Navigation
    document.querySelectorAll('a[href]').forEach(link => {
        link.addEventListener('click', function (e) {
            const url = link.getAttribute('href');
            if (!url.startsWith('#') && !link.hasAttribute('download')) {
                e.preventDefault();
                document.body.style.opacity = 0;
                setTimeout(() => {
                    window.location.href = url;
                }, 300);
            }
        });
    });

    // üî¥ Best√§tigung beim L√∂schen
    document.querySelectorAll("form.delete-form").forEach(form => {
        form.addEventListener("submit", function (e) {
            const confirmed = confirm("‚ùó Willst du dieses Tutorial wirklich l√∂schen?");
            if (!confirmed) {
                e.preventDefault();
            }
        });
    });
</script>

<div id="fade-overlay"></div>
{% endblock %}
